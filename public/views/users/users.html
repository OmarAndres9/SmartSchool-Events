<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestión Usuarios - SmartSchool</title>
  <!-- Bulma CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.4/css/bulma.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Custom Dashboard CSS -->
  <link rel="stylesheet" href="../../css/dashboard.css">
</head>

<body>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h1 class="brand-title"><i class="fas fa-graduation-cap"></i> SmartSchool</h1>
    </div>

    <div class="sidebar-menu">
      <a href="../../index.html" class="menu-link">
        <i class="fas fa-home"></i> Inicio
      </a>
      <a href="../dashboard.html" class="menu-link">
        <i class="fas fa-calendar-alt"></i> Agenda Escolar
      </a>
      <a href="../event/event.html" class="menu-link">
        <i class="fas fa-ticket-alt"></i> Mis Eventos
      </a>
      <a href="../users/users.html" class="menu-link active">
        <i class="fas fa-users"></i> Usuarios
      </a>
      <a href="../notifications/notifications.html" class="menu-link">
        <i class="fas fa-bell"></i> Notificaciones
      </a>
      <a href="../logistics/logistics.html" class="menu-link">
        <i class="fas fa-boxes"></i> Logística
      </a>
    </div>
  </aside>

  <!-- Main Content -->
  <div class="main-content">

    <!-- Top Nav -->
    <nav class="top-nav">
      <div class="welcome-msg">
        <h2>Gestión de Usuarios</h2>
        <p>Administra estudiantes, docentes y acudientes.</p>
      </div>

      <div class="user-profile">
        <!-- Notifications -->
        <div class="dropdown is-right is-hoverable">
          <div class="dropdown-trigger">
            <span class="icon is-medium has-text-grey" style="cursor: pointer;">
              <i class="fas fa-bell fa-lg"></i>
            </span>
          </div>
        </div>
        <div style="width: 1px; height: 30px; background: #eee; margin: 0 10px;"></div>
        <img src="../../img/docente.jpg" alt="User" class="avatar">
      </div>
    </nav>

    <!-- Toolbar -->
    <div class="toolbar">
      <div class="control has-icons-left" style="flex: 1;">
        <input class="input" type="text" placeholder="Buscar usuario...">
        <span class="icon is-small is-left">
          <i class="fas fa-search"></i>
        </span>
      </div>
      <div class="select">
        <select>
          <option value="todos">Todos</option>
          <option value="estudiante">Estudiantes</option>
          <option value="docente">Docentes</option>
          <option value="acudiente">Acudientes</option>
        </select>
      </div>
      <a href="add-user.html" class="button is-primary">
        <span class="icon"><i class="fas fa-plus"></i></span>
        <span>Agregar Usuario</span>
      </a>
    </div>

    <!-- User Grid -->
    <section class="user-list">

      <!-- Card 1 -->
      <div class="user-card">
        <div class="user-card-header"></div>
        <img src="../../img/pepe.png" alt="User" class="user-avatar">
        <div class="user-info">
          <h3 class="user-name">Pepe The Frog</h3>
          <span class="user-role">pepe029sd@gmail.com</span>
          <span class="tag tag-student">Estudiante - 801</span>
        </div>
        <div class="card-actions">
          <button class="action-btn" title="Ver"><i class="fas fa-eye"></i></button>
          <button class="action-btn" title="Editar"><i class="fas fa-pen"></i></button>
          <button class="action-btn" title="Configurar"><i class="fas fa-cog"></i></button>
        </div>
      </div>

      <!-- Card 2 -->
      <div class="user-card">
        <div class="user-card-header"></div>
        <img src="../../img/docente.jpg" alt="User" class="user-avatar">
        <div class="user-info">
          <h3 class="user-name">Ana Pérez</h3>
          <span class="user-role">Ana_p@gmail.com</span>
          <span class="tag tag-teacher">Docente - Matemáticas</span>
        </div>
        <div class="card-actions">
          <button class="action-btn" title="Ver"><i class="fas fa-eye"></i></button>
          <button class="action-btn" title="Editar"><i class="fas fa-pen"></i></button>
          <button class="action-btn" title="Configurar"><i class="fas fa-cog"></i></button>
        </div>
      </div>

      <!-- Card 3 -->
      <div class="user-card">
        <div class="user-card-header"></div>
        <img src="../../img/mama.jpg" alt="User" class="user-avatar">
        <div class="user-info">
          <h3 class="user-name">Mrs. Frog</h3>
          <span class="user-role">Mfrog09@gmail.com</span>
          <span class="tag tag-admin">Acudiente</span>
        </div>
        <div class="card-actions">
          <button class="action-btn" title="Ver"><i class="fas fa-eye"></i></button>
          <button class="action-btn" title="Editar"><i class="fas fa-pen"></i></button>
          <button class="action-btn" title="Eliminar" style="color: #e53935;"><i class="fas fa-trash"></i></button>
        </div>
      </div>

    </section>

  </div>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const userList = document.querySelector('.user-list');
      userList.innerHTML = '<p class="has-text-centered">Cargando usuarios...</p>';

      try {
        const response = await fetch('../../../src/backend/users/list.php');
        const users = await response.json();

        userList.innerHTML = '';

        if (users.length === 0) {
          userList.innerHTML = '<p class="has-text-centered">No hay usuarios registrados.</p>';
          return;
        }

        users.forEach(user => {
          const card = document.createElement('div');
          card.className = 'user-card';

          // Mapear rol a clase de tag para color
          let tagClass = 'tag-student';
          if (user.rol === 'Docente') tagClass = 'tag-teacher';
          if (user.rol === 'Administrador' || user.rol === 'Acudiente') tagClass = 'tag-admin';

          card.innerHTML = `
                    <div class="user-card-header"></div>
                    <img src="../../img/pepe.png" alt="User" class="user-avatar">
                    <div class="user-info">
                        <h3 class="user-name">${user.nombre}</h3>
                        <span class="user-role">${user.correo}</span>
                        <span class="tag ${tagClass}">${user.rol} - ${user.usuario}</span>
                    </div>
                    <div class="card-actions">
                        <button class="action-btn" title="Ver"><i class="fas fa-eye"></i></button>
                        <button class="action-btn" title="Editar"><i class="fas fa-pen"></i></button>
                        <button class="action-btn" title="Configurar"><i class="fas fa-cog"></i></button>
                    </div>
                `;
          userList.appendChild(card);
        });

      } catch (error) {
        console.error('Error:', error);
        userList.innerHTML = '<p class="has-text-centered error">Error al cargar usuarios</p>';
      }
    });
  </script>
  <!-- <script src="../../../public/js/users.js"></script> -->
</body>

</html>